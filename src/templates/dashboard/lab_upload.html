{% extends 'dashboard/dashboard_base.html' %}

{% comment %}
Interface for uploading new lab environments to Lawliet.
{% endcomment %}

{% block title %}Upload lab | {{ block.super }}{% endblock %}
{% block page_header %}Upload new lab environment{% endblock %}

{% block page-content %}
<div class="uk-container uk-margin-bottom">
  {# Show alert after successful upload #}
  {% if success %}
  <div class="uk-alert uk-alert-success" role="alert">
    <p>Your environment was uploaded to the server!</p>
    {% if uploaded_id %}
    <p>Its ID is {{ uploaded_id }}.</p>
    {% endif %}
  </div>
  {% endif %}

  {# Upload form #}
  <form class="uk-form uk-width-1-1" method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    {# TODO: add non-field errors #}

    <div class="uk-panel uk-panel-box">
      <fieldset>
        {% for field in lab_form %}
        <h2 class="uk-h2">{{ field.label }}</h2>
        {% if field.help_text %}
        <p>{{ field.help_text }}</p>
        {% endif %}
        <div>
          {{ field }}
          {% include "includes/field_errors.html" with errors=field.errors only %}
        </div>
        {% endfor %}
      </fieldset>
    </div>

    <button type="submit" class="uk-button uk-margin-top" id="lab-save-button">
      Save lab
    </button>
  </form>
</div>
{% endblock %}

{% block css %}
{{ block.super }}
{% load static %}
<link rel="stylesheet" href="{% static 'codemirror/lib/codemirror.css' %}">
<link rel="stylesheet" href="{% static 'css/components/htmleditor.min.css' %}">
{% endblock %}

{% block javascripts %}
{{ block.super }}
{% load static %}
<script src="{% static 'codemirror/lib/codemirror.js' %}"></script>
<script src="{% static 'codemirror/mode/markdown/markdown.js' %}"></script>
<script src="{% static 'codemirror/addon/mode/overlay.js' %}"></script>
<script src="{% static 'codemirror/mode/xml/xml.js' %}"></script>
<script src="{% static 'codemirror/mode/gfm/gfm.js' %}"></script>
<script src="{% static 'js/marked.min.js' %}"></script>
<script src="{% static 'js/components/htmleditor.min.js' %}"></script>
{% endblock %}
